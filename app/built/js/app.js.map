{"version":3,"sources":["app.js"],"names":["choosableColors","YlGn","GnBu","BuPu","PuRd","RdPu","YlOrRd","baseColors","Pu","Bu","Gn","Or","Rd","colors","$","ctx","sel","document","querySelector","$$","Array","prototype","slice","call","querySelectorAll","chooseRandomFromArray","arr","Math","floor","random","length","chooseRandomFromObject","obj","Object","keys","leftPad","str","pad","len","join","getGradient","fromClr","toClr","numStops","stops","map","x","parseInt","i","f","k","toString","wrapText","text","el","SVG","words","split","line","lineHeight","svg","createElementNS","textNode","tspan","width","ceil","getBoundingClientRect","builder","dy","word","setAttributeNS","appendChild","shift","push","textContent","getComputedTextLength","pop","removeChild","trianglify","colorSet","animate","cell_size","wrapperParent","wrapper","parentNode","maskId","getAttribute","height","canvas","createElement","getContext","Trianglify","variance","polys","templ","className","fading","defaultNumStops","lastTimestamp","chosenColors","changeColorSet","set","a","indexOf","clr","p","fillStyle","strokeStyle","beginPath","moveTo","apply","lineTo","fill","stroke","randClr","lineWidth","style","position","insertAdjacentHTML","animFrame","timestamp","stop","clrStops","requestAnimationFrame","chosenRandClr","titleCanvas","changeTitleColorSet","window","onload","color","cursor","onclick","choosableClrs","splice","onresize"],"mappings":"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","file":"app.js","sourcesContent":["(() => {\r\n  // Colours from ColorBrewer\r\n  // https://bl.ocks.org/mbostock/5577023\r\n  const choosableColors = {\r\n    YlGn: [\"#addd8e\",\"#78c679\",\"#41ab5d\",\"#238443\"],\r\n    GnBu: [\"#7bccc4\",\"#4eb3d3\",\"#2b8cbe\",\"#0868ac\"],\r\n    BuPu: [\"#8c96c6\",\"#8c6bb1\",\"#88419d\",\"#810f7c\"],\r\n    PuRd: [\"#e7298a\",\"#ce1256\",\"#980043\",\"#67001f\"],\r\n    RdPu: [\"#f768a1\",\"#dd3497\",\"#ae017e\",\"#7a0177\"],\r\n    YlOrRd: [\"#feb24c\",\"#fd8d3c\",\"#fc4e2a\",\"#e31a1c\"]\r\n  }\r\n  const baseColors = {\r\n    Pu: [\"#807dba\",\"#6a51a3\",\"#54278f\",\"#3f007d\"],\r\n    Bu: [\"#4292c6\",\"#2171b5\",\"#08519c\",\"#08306b\"],\r\n    Gn: [\"#41ab5d\",\"#238b45\",\"#006d2c\",\"#00441b\"],\r\n    Or: [\"#f16913\",\"#d94801\",\"#a63603\",\"#7f2704\"],\r\n    Rd: [\"#ef3b2c\",\"#cb181d\",\"#a50f15\",\"#67000d\"]\r\n  };\r\n  const colors = { ...choosableColors, ...baseColors };\r\n  \r\n  const $ = (ctx, sel) => (!sel ? document : ctx).querySelector(sel || ctx),\r\n        $$ = (ctx, sel) => Array.prototype.slice.call((!sel ? document : ctx).querySelectorAll(sel || ctx));\r\n\r\n  const chooseRandomFromArray = (arr) => arr[Math.floor(Math.random()*arr.length)];\r\n\r\n  const chooseRandomFromObject = (obj) => obj[chooseRandomFromArray(Object.keys(obj))];\r\n\r\n  const leftPad = (str, pad, len) => str.length < len ? (new Array(len - str.length + 1).join(pad) + str) : str;\r\n\r\n  const getGradient = (fromClr, toClr, numStops) => {\r\n    let stops = new Array(numStops);\r\n    \r\n    fromClr = fromClr.slice(1);\r\n    toClr = toClr.slice(1);\r\n\r\n    if (fromClr.length === 6) {\r\n      fromClr = [fromClr.slice(0, 2), fromClr.slice(2, 4), fromClr.slice(4)].map((x) => parseInt(x, 16));\r\n    } else {\r\n      fromClr = [fromClr[0], fromClr[1], fromClr[2]].map((x) => 17 * parseInt(x, 16));\r\n    }\r\n    if (toClr.length === 6) {\r\n      toClr = [toClr.slice(0, 2), toClr.slice(2, 4), toClr.slice(4)].map((x) => parseInt(x, 16));\r\n    } else {\r\n      toClr = [toClr[0], toClr[1], toClr[2]].map((x) => 17 * parseInt(x, 16));\r\n    }\r\n\r\n    for (let i=0; i<stops.length; i++) {\r\n      stops[i] = '#' + fromClr.map((f, k) => leftPad(Math.floor(f + (i + 1) * (toClr[k] - f) / numStops).toString(16), 0, 2)).join('');\r\n    }\r\n\r\n    return stops;\r\n  };\r\n    \r\n  // wrap text to constraints of el\r\n  // returns a SVG string\r\n  // inspired by https://bl.ocks.org/mbostock/7555321\r\n  let wrapText = (text, el) => {\r\n    const SVG = \"http://www.w3.org/2000/svg\";\r\n    let words = text.split(/\\s/),\r\n        line = [],\r\n        lineHeight = 1,\r\n        svg = document.createElementNS(SVG, 'svg'),\r\n        textNode = document.createElementNS(SVG, 'text'),\r\n        tspan = document.createElementNS(SVG, 'tspan'),\r\n        width = Math.ceil(el.getBoundingClientRect().width), // give some wiggle room\r\n        builder = [],\r\n        dy = 0.95,\r\n        word;\r\n    \r\n    tspan.setAttributeNS(SVG, 'x', 0);\r\n    tspan.setAttributeNS(SVG, 'y', 0);\r\n    textNode.appendChild(tspan);\r\n    svg.appendChild(textNode);\r\n    el.appendChild(svg);\r\n    \r\n    while (word = words.shift()) {\r\n      line.push(word);\r\n      tspan.textContent = line.join(' ');\r\n      if (tspan.getComputedTextLength() > width) {\r\n        line.pop();\r\n        builder.push(`<tspan x=\"0\" y=\"0\" dy=\"${dy}em\">${line.join(' ')}</tspan>`);\r\n        line = [word];\r\n        dy += lineHeight;\r\n      }\r\n    }\r\n    builder.push(`<tspan x=\"0\" y=\"0\" dy=\"${dy}em\">${line.join(' ')}</tspan>`);\r\n    \r\n    el.removeChild(svg);\r\n    \r\n    return builder.join('');\r\n  };\r\n\r\n  let trianglify = (el, colorSet, animate = false, cell_size = 32) => {\r\n    let wrapper = $(el, '.text-wrap'),\r\n        wrapperParent = wrapper.parentNode, // no guarantee wrapper.parentNode === el\r\n        text = wrapper.textContent,\r\n        maskId = 'mask-' + el.getAttribute('id'),\r\n        { width, height } = wrapper.getBoundingClientRect(),\r\n        canvas = document.createElement('canvas'),\r\n        ctx = canvas.getContext('2d'),\r\n        { polys } = Trianglify({\r\n          width,\r\n          height,\r\n          cell_size, //Math.floor(parseInt(window.getComputedStyle(el, null).fontSize) / 4),\r\n          variance: .69\r\n        }),\r\n        templ = `<span class=\"trianglify-text\" style=\"width:${width}px;height:${height}px\">\r\n    <svg class=\"trianglify-svg\" xmlns=\"http://www.w3.org/2000/svg\">\r\n      <defs>\r\n        <mask id=\"${maskId}\" x=\"0\" y=\"0\" width=\"100%\" height=\"100%\">\r\n          <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\"></rect>\r\n          <text class=\"${el.className}\" x=\"0\" y=\"0\" dy=\".95em\">${wrapText(text, wrapper)}</text>\r\n        </mask>\r\n      </defs>\r\n      <rect x=\"0\" y=\"0\" width=\"100%\" height=\"100%\" fill=\"white\" mask=\"url(#${maskId})\"/>\r\n  </span>\r\n  <span class=\"trianglify-ghost-text\">${text}</span>`,\r\n        fading = [],\r\n        defaultNumStops = 75, // 4500 / 60; each change takes 4.5 seconds\r\n        lastTimestamp = 0, // for animation\r\n        chosenColors;\r\n    \r\n    let changeColorSet = (set) => {\r\n      chosenColors = set;\r\n      polys = polys.map((a) => [chosenColors.indexOf(chooseRandomFromArray(chosenColors)), a[1]]);\r\n      fading = new Array(polys.length);\r\n\r\n      for (let i=0; i<polys.length; i++) {\r\n        let [clr, p] = polys[i];\r\n        ctx.fillStyle = ctx.strokeStyle = chosenColors[clr];\r\n        ctx.beginPath();\r\n        ctx.moveTo.apply(ctx, p[0]);\r\n        ctx.lineTo.apply(ctx, p[1]);\r\n        ctx.lineTo.apply(ctx, p[2]);\r\n        ctx.fill();\r\n        ctx.stroke();\r\n        \r\n        if (Math.random() < 0.1) {\r\n          let randClr = chooseRandomFromArray(chosenColors);\r\n          fading[i] = [0, getGradient(chosenColors[clr], randClr, defaultNumStops), p];\r\n          polys[i][0] = chosenColors.indexOf(randClr);\r\n        }\r\n      }\r\n    };\r\n      \r\n    ctx.lineWidth = 0.001;\r\n\r\n    el.style.position = 'relative';\r\n    el.style.height = height + 'px';\r\n    el.style.width = width + 'px';\r\n    \r\n    canvas.width = width - 2;\r\n    canvas.height = height - 2;\r\n    canvas.className = 'trianglify-canvas';\r\n    \r\n    changeColorSet(colorSet);\r\n    \r\n    wrapperParent.removeChild(wrapper);\r\n    \r\n    wrapperParent.insertAdjacentHTML('beforeend', templ);\r\n    wrapperParent.appendChild(canvas);\r\n    \r\n    if (animate) {\r\n      let animFrame = (timestamp) => {\r\n        // randomly fade a few polygons\r\n        for (let i=0; i<fading.length; i++) {\r\n          if (!fading[i]) continue;\r\n          let [stop, clrStops, p] = fading[i];\r\n          ctx.fillStyle = ctx.strokeStyle = clrStops[stop];\r\n          ctx.beginPath();\r\n          ctx.moveTo.apply(ctx, p[0]);\r\n          ctx.lineTo.apply(ctx, p[1]);\r\n          ctx.lineTo.apply(ctx, p[2]);\r\n          ctx.fill();\r\n          ctx.stroke();\r\n\r\n          if (stop + 1 < clrStops.length)\r\n            fading[i][0] = stop + 1;\r\n          else\r\n            delete fading[i];\r\n        }\r\n\r\n        // every 1/2 second, fade a few more\r\n        if (timestamp - lastTimestamp > 500) {\r\n          for (let i=0; i<polys.length; i++) {\r\n            let [clr, p] = polys[i];\r\n            if (!!fading[i]) continue;\r\n            if (Math.random() < 0.03) {\r\n              let randClr = chooseRandomFromArray(chosenColors);\r\n              fading[i] = [0, getGradient(chosenColors[clr], randClr, defaultNumStops), p];\r\n              polys[i][0] = chosenColors.indexOf(randClr);\r\n            }\r\n          }\r\n\r\n          lastTimestamp = timestamp;\r\n        }\r\n\r\n        return requestAnimationFrame(animFrame);\r\n      };\r\n      \r\n      animFrame(0);\r\n    }\r\n    \r\n    return {\r\n      canvas,\r\n      changeColorSet\r\n    };\r\n  }\r\n\r\n  let chosenRandClr = chooseRandomFromArray(Object.keys(choosableColors)), titleCanvas, changeTitleColorSet;\r\n  window.onload = () => {\r\n    let randClr = choosableColors[chosenRandClr],\r\n        { canvas, changeColorSet } = trianglify($('#title'), randClr, true);\r\n    \r\n    titleCanvas = canvas;\r\n    changeTitleColorSet = changeColorSet;\r\n    \r\n    for (let a of $$('#site-header .subtitle a')) {\r\n      a.style.color = randClr[2];\r\n    }\r\n  \r\n    $('#title').style.cursor = 'pointer';\r\n    $('#title').onclick = () => {\r\n      let choosableClrs = Object.keys(choosableColors);\r\n      choosableClrs.splice(choosableClrs.indexOf(chosenRandClr), 1);\r\n      \r\n      chosenRandClr = chooseRandomFromArray(choosableClrs);\r\n      randClr = choosableColors[chosenRandClr];\r\n      \r\n      changeTitleColorSet(randClr);\r\n      \r\n      for (let a of $$('#site-header .subtitle a')) {\r\n        a.style.color = randClr[2];\r\n      }\r\n    };\r\n\r\n    trianglify($('#about-heading'), colors.Or);\r\n    trianglify($('#portfolio-heading'), colors.Rd);\r\n    trianglify($('#blog-heading'), colors.Bu);\r\n    trianglify($('#contact-heading'), colors.Gn);\r\n  };\r\n  \r\n  window.onresize = () => {\r\n    let { canvas, changeColorSet } = trianglify($('#title'), choosableColors[chosenRandClr], true);\r\n    \r\n    titleCanvas = canvas;\r\n    changeTitleColorSet = changeColorSet;\r\n  }\r\n})();"]}